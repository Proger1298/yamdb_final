[![yamdb_workflow](https://github.com/Proger1298/yamdb_final/actions/workflows/yamdb_workflow.yml/badge.svg)](https://github.com/Proger1298/yamdb_final/actions/workflows/yamdb_workflow.yml)

IP: 
```
158.160.47.169
```

# Описание:

Проект YaMDb собирает отзывы (Review) пользователей на произведения (Title). Произведения делятся на категории: "Книги", "Фильмы", "Музыка". Список категорий (Category) может быть расширен.

Сами произведения в YaMDb не хранятся, здесь нельзя посмотреть фильм или послушать музыку.
В каждой категории есть произведения: книги, фильмы или музыка. Например, в категории "Книги" могут быть произведения "Винни Пух и все-все-все" и "Марсианские хроники", а в категории "Музыка" — песня "Давеча" группы "Насекомые" и вторая сюита Баха. Произведению может быть присвоен жанр из списка предустановленных (например, "Сказка", "Рок" или "Артхаус"). Новые жанры может создавать только администратор.

Благодарные или возмущённые пользователи оставляют к произведениям текстовые отзывы и ставят произведению оценку в диапазоне от одного до десяти (целое число); из пользовательских оценок формируется усреднённая оценка произведения — рейтинг (целое число). На одно произведение пользователь может оставить только один отзыв.Пользователи могут оставлять комментарии к отзывам.Добавлять отзывы, комментарии и ставить оценки могут только аутентифицированные пользователи.

**Шаблон наполнения env-файла**

DB_ENGINE=.. # указываем, что работаем с postgresql ( или не с ней :) )

DB_NAME=... # имя базы данных

POSTGRES_USER=... # логин для подключения к базе данных

POSTGRES_PASSWORD=...

DB_HOST=... # название сервиса (контейнера)

DB_PORT=... # порт для подключения к БД

**Описание команд для запуска приложения в контейнерах**

Для сборки и запуска контейнеров
``` docker-compose up -d --build ```

Затем последовательно выполните комнады:

```docker-compose exec web python manage.py migrate```

```docker-compose exec web python manage.py createsuperuser``` - для создания супер пользователя Django

```docker-compose exec web python manage.py collectstatic --no-input```

**Ресурсы API YaMDb:**
```
AUTH: аутентификация.
```
```
USERS: пользователи.
```
```
TITLES: произведения, к которым пишут отзывы (определённый фильм, книга или песенка).
```
```
CATEGORIES: категории (типы) произведений ("Фильмы", "Книги", "Музыка").
```
```
GENRES: жанры произведений. Одно произведение может быть привязано к нескольким жанрам.
```
```
REVIEWS: отзывы на произведения. Отзыв привязан к определённому произведению.
```
```
COMMENTS: комментарии к отзывам. Комментарий привязан к определённому отзыву.
```
# Пользовательские роли:

**Аноним** — может просматривать описания произведений, читать отзывы и комментарии.

**Аутентифицированный пользователь (user)** — может читать всё, как и Аноним, дополнительно может публиковать отзывы и ставить рейтинг произведениям (фильмам/книгам/песенкам), может комментировать чужие отзывы и ставить им оценки; может редактировать и удалять свои отзывы и комментарии. Эта роль присваивается по умолчанию каждому новому пользователю.

**Модератор (moderator)** — те же права, что и у Аутентифицированного пользователя плюс право удалять и редактировать любые отзывы и комментарии.

**Администратор (admin)** — полные права на управление проектом и всем его содержимым. Может создавать и удалять произведения, категории и жанры. Может назначать роли пользователям.

**Администратор Django** — те же права, что и у роли Администратор.

# Алгоритм регистрации пользователей:
Пользователь отправляет POST-запрос на добавление нового пользователя с параметрами email и username на эндпоинт 
```
/api/v1/auth/signup/.
```
YaMDB отправляет письмо с кодом подтверждения (confirmation_code) на адрес email.
Пользователь отправляет POST-запрос с параметрами username и confirmation_code на эндпоинт 
```
/api/v1/auth/token/
```
В ответе на запрос ему приходит token (JWT-токен).
При желании пользователь отправляет PATCH-запрос на эндпоинт /api/v1/users/me/ и заполняет поля в своём профайле (описание полей — в документации).

# Установка проекта:

**Cоздать и активировать виртуальное окружение:**

```
python -m venv venv 
```
```
source venv/bin/activate 
```

**Установить зависимости из файла requirements.txt:**

```
python3 -m pip install --upgrade pip 
```
```
pip install -r requirements.txt 
```

**Выполнить миграции:**

```
python manage.py migrate 
```

**Запуск проекта:**
```
python manage.py runserver
```
# Пример работы запросов:


**AUTH:**

**POST-запрос на получение кода подтверждения**

```
/api/v1/auth/signup/ 
```
Вводим требуемые данные!
```
{
    "email": "sdfsdf@mail.ru",
    "username": "Vital0sdas"
}
```
Результат
```
"email": "sdfsdf@mail.ru",
"username": "Vital0sdas"
```
Письмо с кодом подтверждения будет отправленно на указанный email
**Warning!** Поля email и username должны быть уникальными.!

**POST-запрос на получение JWT токена**
```
/api/v1/auth/token/ 
```
Вводим требуемые данные!
```
{
"username": "Vital0sdas",
"confirmation_code": "65-dnm2389fdndb81272h22dc"
}
```
Результат
```
{
"token": e329378384u83euhe3.343fdofjksdopfjsdp.325453466hrthggadfvsFGUJ
}
```

**TITLES:**

**GET-запрос на получение информации о произведении**

```
/api/v1/titles/1/
```
Результат
```
{
    "id": 1,
    "genre": [
        {
            "slug": "comedian-drama",
            "name": "Комедийная драмма"
        }
    ],
    "category": {
        "slug": "movies",
        "name": "Фильмы"
    },
    "rating": 10,
    "name": "Форест Гамп",
    "year": 1994,
    "description": "Сидя на автобусной остановке, Форрест Гамп — не очень умный, но добрый и открытый парень — рассказывает случайным встречным историю своей необыкновенной жизни. С самого малолетства парень страдал от заболевания ног, соседские мальчишки дразнили его, но в один прекрасный день Форрест открыл в себе невероятные способности к бегу. Подруга детства Дженни всегда его поддерживала и защищала, но вскоре дороги их разошлись."
}
```

**GENRES:**

**GET-запрос на получение списка всех жанров, доступных в проекте**
```
api/v1/genres/
```
Результат
```
{
    "count": 3,
    "next": null,
    "previous": null,
    "results": [
        {
            "slug": "comedian-drama",
            "name": "Комедийная драмма"
        },
        {
            "slug": "comedy",
            "name": "Комедия"
        },
        {
            "slug": "drama",
            "name": "Драма"
        }
    ]
}
```

**REVIEWS:**

**GET-запрос на получение информации о всех оставленных отзывах на конкретное произведение**
```
api/v1/titles/1/reviews/
```
Результат
```
{
    "count": 2,
    "next": null,
    "previous": null,
    "results": [
        {
            "id": 2,
            "text": "Цепляет!",
            "author": "Boris",
            "score": 9,
            "pub_date": "2022-11-19T10:45:02.318088Z"
        },
        {
            "id": 1,
            "text": "Самый лучший фильм на свете!!!",
            "author": "Tolya",
            "score": 10,
            "pub_date": "2022-11-19T09:16:38.776910Z"
        }
    ]
}
```

# В проекте применены технологии:

Python 3.7.9

Django 2.2.16

Django REST Framework 3.12.4

# Авторы:
**Антон Кучеренко** https://github.com/Proger1298

**Антон Лобов** https://github.com/Lob-starr

**Виталий Станкевич** https://github.com/vital00000